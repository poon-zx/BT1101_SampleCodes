---
title: "BT1101 17/18 Sem 2"
output: html_document
---

## Preparation

```{r preparation, echo=TRUE, warning = FALSE, message = FALSE}

# predictive/prescriptive analytics
library(tseries) 
library(forecast)
library(lpSolve)
library(TTR)

# descriptive analytics
library(psych)
library(Rmisc)
library(rcompanion)
library(rpivotTable)
library(EnvStats) 
library(car)
library(rstatix)

# general use
library(dplyr)
library(tidyr)
library(knitr)
```

# Question 1 (6m)

(a) A financial advisor believes that the proportion of investors who are risk-averse (i.e. try to avoid risk in their investment decisions) is at least 0.7. A survey of 32 investors found that 20 of them were risk-averse. Formulate and test the hypotheses to determine whether his belief is valid. (3 marks)

(b) A management institute checked the past records of applicants and the mean score calculated was 350. The administration is interested to know whether the quality of new applicants has changed or not. From the recent scores of 100 applicants, the mean is 365 with a standard deviation of 38. Does this data provide statistical evidence that the quality of recent applicants has improved? (3 marks)

```{r Q1a, echo = TRUE}

# proportion hypo testing use z value
prop <- 20/32
z <- (prop - 0.7) / sqrt(0.7*(1-0.7)/32)
# compute critical value
cv95 <- qnorm(0.05)
# since H1 is stated as <, rejection region is in lower tail
z < cv95
```

Let u be the proportion of investors which are risk-averse.

H0: u \>= 0.7 and H1: u \< 0.7

Since the test statistic z is larger than the critical value (left tail), we fail to reject the null hypothesis (H0). Therefore, the data shows evidence that the proportion of investors who are risk-averse (i.e. try to avoid risk in their investment decisions) is at least 0.7.

```{r Q1b, echo=TRUE}

# one tailed hypo testing

t <- (365-350)/(38/sqrt(100))
ct <- qt(0.95, 99)
t 
ct

```

Let v be the mean score of applicants.

H0: v \<= 350 and H1: v \> 350

Since the test-statistic t is larger than the critical value (right tail), we reject the null hypothesis (H0). Thus, we accept H1 and conclude that the data does provide statistic evidence at the 5% level of significance that the quality of recent applicants have improved as the mean score has increased from 350.

# Question 2 (4m)

"Data used in business analytics need to be reliable and valid."

(a) Explain what "reliable" and "valid" data mean (providing appropriate examples in your explanation). (2 marks)

(b) Explain whether you agree with the above statement. (2 marks)

<!-- -->

a)  Reliable data refers to data that is accurate and consistent while valid data means that data correctly measures what they are supposed to measure.

For example, a tire pressure gauge that consistently reads several pounds of pressure below the true value is not reliable, although it is valid because it does measure tire pressure.

The number of calls to a customer service desk might be counted correctly each day (and thus is a reliable measure), but not valid if it is used to assess customer dissatisfaction, as many calls may be simple queries.

b)  I do agree with the above statement as without reliable data, our observations and predictions drawn from the data would not be useful or meaningful as the initial data is already inaccurate. Data also needs to be valid in order to ensure that the data is applicable, hence related to above only then can we conduct meaningful analysis on the data.

Answer Key: Yes. If data used in business analytics is not reliable, for example, the weight of a product sold by a company is constantly above the stated and expected value, the company might end up incurring extra costs and not even realize it till it is too late. If data used in business analytics is not valid, for example, a ruler is used to measure the weight of goods produced by a company, the company would end up having invalid data that is useless and unable to be used for analysis of its goods.

# Question 3 (25m)

(a) Describe what you think each record in the database describes. (1 mark)

(b) Explain with reference to the results generated,

    i\. what type of distribution best describes the variable "BMI Calculation". (1 mark)

<!-- -->

(ii) how many female records are there in the database? (1 mark)

(iii) what is the mean BMI calculation for members with 'Average' body type? [round off final answer to 2 decimal places] (1 mark)

(iv) what is the 95% confidence interval for 'time spent in gym'? [round off final answer to 2 decimal places] (2 mark)

     c)  Draw a contingency table with rows = Gender, columns Body Type, and cells = Frequency. (1 mark)

     d)  Describe the linear relationship between "BMI Calculation" and other variables in the database? (2 marks)

(e)(i) State the hypotheses that Tom is testing in Fig 3.8 & Fig 3.9. (2 marks)

Let u1 be the population mean of BMI Calculation while u2 be the

(e)(ii) What conclusions can Tom draw from his analyses. Explain your answer with respect to the type of analyses he conducted and the results he obtained. (4 marks)

(f) Tom wants to know if the time spent in gym is significantly different for people of different body type. Suggest what descriptive analytics he could conduct and describe the different steps he needs to take to conduct this analytics. (5 marks)

(g) Tom needs help in computing the 95% prediction interval for the distance of run. Compute the prediction interval and explain the results to Tom. Round off the final answer to 2 decimal places. (5 marks)

<!-- -->

a)  Each record describes a different customer that visits the gym

b)  

    i)  A normal distribution. Looking at the Shapiro-Wilk Test, the W value is high and the p-value is \> 0.05, which suggests that the data does not deviate from a normal distribution. [H0: Data drawn from a normally distributed population. H1: Data not drawn from a normally distributed population. There is insufficient evidence to prove that the data is not normally distributed, hence we do not reject H0 and conclude that the data is normally distributed at the 5% level of significance.] The histogram also resembles that of a normal distribution.
    ii) 10
    iii) 
    iv) (22.56 + 27.97) / 2 = 25.27 (to 2 dp)

```{r q2bvi, echo=TRUE}
uCI95 <- 162.29 - qt(0.025, df =22)*107.8/sqrt(23)
ICI95 <- 162.29 + qt(0.025, df =22)*107.8/sqrt(23)
print(cbind(ICI95, uCI95), digits = 5)
```

b)  

    iv) The 95% confidence interval is [115.67, 208.91].

c)  Looking at the probability values, the correlation values between BMI Calculation and Pant size, Weight, Height are statistically significant as the p-value \< 0.05, hence a meaningful conclusion about their linear correlation can be drawn.

Then read off the values

e)  (From Answer Key cuz idk how do)

    i\. For fig3.8: H0: No true difference between mean BMI Calculation between the two genders. H1: True difference in mean BMI Calculation between two genders is not equal to 0.

    For fig 3.9: H0: No true difference in the mean time spent in gym between the two genders. H1: True difference in mean time spent in gym is not equal to 0.

ii\. (From Answer Key cuz idk how do)

For fig 3.8, since the p-value of the test is 0.006188\<0.05, we conclude that there is sufficient evidence to reject H0 in favour of H1 at the 5% level of significance. We conclude that there is indeed a true difference in mean BMI Calculation between males and females.

For fig 3.9, since the p-value of the test is 0.06628\>0.05, we conclude that there is insufficient evidence to reject H0, hence we accept H0 at the 5% level of significance. We conclude that there is no true difference in the mean time spent in gym between males and female.

```{r 2g, echo = TRUE}

# prediction interval
IPI <- 2.07 + (qt(0.025, df = 22)*1.54*sqrt(1+1/23))
uPI <- 2.07 - (qt(0.025, df = 22)*1.54*sqrt(1+1/23))
print(cbind(IPI, uPI), digits = 3)
```

g)  Before calculating the prediction interval, we have to check if the data is normally distributed and if it is not then we have to transform the data to a normal distribution. This is because the calculation of prediction intervals assumes the data is normally distributed. Looking at the Shapiro-Wilk Test, since the W value is high and the p-value \> 0.05, this indicates that the distribution of the data does not deviate from normality.

The prediction interval is a range for predicting the value of a new observation from the same population. Since the distance of run cannot be a negative number, the 95% prediction interval is [0, 5.33], which means we can be 95% sure that the next new distance of run observation will fall within this range.

# Question 4 (7m)

Develop an optimization model for minimum cost that meets the nutritional requirements. (7 marks)

| Minimize cost using decision variables $X_1$, $X_2$, $X_3$, $X_4$, $X_5$, $X_6$, $X_7$, $X_8$, $X_9$ = kg of Ingredients A to I to include | Cost = 0.48 $X_1$ + 0.39$X_2$ + 0.21 $X_3$ + 0.23 $X_4$ + 0.15 $X_5$ + 0.11 $X_6$ + 0.66 $X_7$ + 0.25 $X_8$ + 0.52 $X_9$  |
|--------------------------------------|----------------------------------|
| Subject to                                                                                                                                 |                                                                                                                           |
| Protein Constraint                                                                                                                         | 15.7 $X_1$ + 13.1$X_2$ + 8.6 $X_3$ + 17.2 $X_4$ + 6.7 $X_5$ + 12.4 $X_6$ + 17.4 $X_7$ + 13.9 $X_8$ + 15.3 $X_9$ $\geq$ 11 |
| Fat Constraint                                                                                                                             | 28.8 $X_1$ + 4.3 $X_2$ + 4.7 $X_3$ + 6.2 $X_4$ + 3.9 $X_5$ + 1.5 $X_6$ + 14.7 $X_7$ + 4.6 $X_8$ + 12.4 $X_9$ $\geq$ 28    |
| Fiber Constraint                                                                                                                           | 25.7 $X_1$ + 5.6 $X_2$ + 2.8 $X_3$ + 3.1 $X_4$ + 1.7 $X_5$ + 2.5 $X_6$ + 23.4 $X_7$ + 13.2 $X_8$ + 15.3 $X_9$ $\leq$ 4    |
| Non-Negativity Constraints (can just put this)                                                                                             | $X_1$ to $X_9$ $\geq$ 0                                                                                                   |
| Non-Negativity Constraint for Ingredient A                                                                                                 | $X_1$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ $\geq$ 0                            |
| Non-Negativity Constraint for Ingredient B                                                                                                 | $\quad$ + $X_2$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ $\geq$ 0                            |
| Non-Negativity Constraint for Ingredient C                                                                                                 | $\quad$ + $\quad$ + $X_3$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ $\geq$ 0                            |
| Non-Negativity Constraint for Ingredient D                                                                                                 | $\quad$ + $\quad$ + $\quad$ + $X_4$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ $\geq$ 0                            |
| Non-Negativity Constraint for Ingredient E                                                                                                 | $\quad$ + $\quad$ + $\quad$ + $\quad$ + $X_5$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ $\geq$ 0                            |
| Non-Negativity Constraint for Ingredient F                                                                                                 | $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $X_6$ + $\quad$ + $\quad$ + $\quad$ $\geq$ 0                            |
| Non-Negativity Constraint for Ingredient G                                                                                                 | $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $X_7$ + $\quad$ + $\quad$ $\geq$ 0                            |
| Non-Negativity Constraint for Ingredient H                                                                                                 | $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $X_8$ + $\quad$ $\geq$ 0                            |
| Non-Negativity Constraint for Ingredient I                                                                                                 | $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $\quad$ + $X_9$ $\geq$ 0                            |

```{r q4, echo = TRUE}
objective.fn <- c(0.48, 0.39, 0.21, 0.23, 0.15, 0.11, 0.66, 0.25, 0.52)
const.mat <- matrix(c(15.7, 13.1, 8.6, 17.2, 6.7, 12.4, 17.4, 13.9, 15.3, 
                      28.8, 4.3, 4.7, 6.2, 3.9, 1.5, 14.7, 4.6, 12.4,
                      25.7, 5.6, 2.8, 3.1, 1.7, 2.5, 23.4, 13.2, 15.3,
                      1,0,0,0,0,0,0,0,0,
                      0,1,0,0,0,0,0,0,0,
                      0,0,1,0,0,0,0,0,0,
                      0,0,0,1,0,0,0,0,0,
                      0,0,0,0,1,0,0,0,0,
                      0,0,0,0,0,1,0,0,0,
                      0,0,0,0,0,0,1,0,0,
                      0,0,0,0,0,0,0,1,0,
                      0,0,0,0,0,0,0,0,1), 
                    ncol = 9,byrow = T)
const.dir <- c(rep('>=',2),'<=',rep('>=',9))
const.rhs <- c(11, 28, 4, rep(0,9))
lp.solution <- lp('min',objective.fn,const.mat,const.dir,const.rhs, compute.sens = T)
lp.solution$solution
lp.solution
```

From the model, we are unable to find a combination of ingredients that are able to fulfill the criteria of having at least 11% protein, 28% fat, and no more than 4% of fiber. Hence, there are no feasible solutions.

# Question 5 (12m)

A linear optimization model is needed to minimize the transportation cost without

exceeding production capacity, and still meet demand from distribution centers.

(a) Develop an optimization model to minimize the transportation cost without exceeding production capacity, and still meet demand from distribution centers. (5 mark)

| Minimize delivery cost using decision variables $X_{i,j}$ which is the number of products Factory i delivers to Center j monthly | Cost = 12.4 $X_{1,1}$ + 13.75 $X_{1,2}$ + 12.3 $X_{1,3}$ + 12.15 $X_{1,4}$ + 18.35 $X_{1,5}$ + 8.5 $X_{2,1}$ + 18.55 $X_{2,2}$ + 8.8 $X_{2,3}$ + 9.85 $X_{2,4}$ + 16.45 $X_{2,5}$ + 9.3 $X_{3,1}$ + 14.25 $X_{3,2}$ + 6.45 $X_{3,3}$ + 11.15 $X_{3,4}$ + 14.95 $X_{3,5}$ |
|--------------------------|----------------------------------------------|
| Subject to                                                                                                                       |                                                                                                                                                                                                                                                                          |
| Factory A Production Capacity Constraint                                                                                         | $X_{1,1}$ + $X_{1,2}$ + $X_{1,3}$ + $X_{1,4}$ + $X_{1,5}$ $\leq$ 1300                                                                                                                                                                                                    |
| Factory B Production Capacity Constraint                                                                                         | $X_{2,1}$ + $X_{2,2}$ + $X_{2,3}$ + $X_{2,4}$ + $X_{2,5}$ $\leq$ 900                                                                                                                                                                                                     |
| Factory C Production Capacity Constraint                                                                                         | $X_{3,1}$ + $X_{3,2}$ + $X_{3,3}$ + $X_{3,4}$ + $X_{3,5}$ $\leq$ 400                                                                                                                                                                                                     |
| Center A Demand Constraint                                                                                                       | $X_{1,1}$ + $X_{2,1}$ + $X_{3,1}$ = 160                                                                                                                                                                                                                                  |
| Center B Demand Constraint                                                                                                       | $X_{1,2}$ + $X_{2,2}$ + $X_{3,2}$ = 330                                                                                                                                                                                                                                  |
| Center C Demand Constraint                                                                                                       | $X_{1,3}$ + $X_{2,3}$ + $X_{3,3}$ = 600                                                                                                                                                                                                                                  |
| Center D Demand Constraint                                                                                                       | $X_{1,4}$ + $X_{2,4}$ + $X_{3,4}$ = 590                                                                                                                                                                                                                                  |
| Center E Demand Constraint                                                                                                       | $X_{1,5}$ + $X_{2,5}$ + $X_{3,5}$ = 880                                                                                                                                                                                                                                  |
| Integer, Non-Negativity Constraints                                                                                              | $X_{i,j}$ all integers and $\geq$ 0                                                                                                                                                                                                                                      |

```{r q5a, echo = TRUE}
objective.fn <- c(12.4, 13.75, 12.3, 12.15, 18.35, 8.5, 18.55, 8.80, 9.85, 16.45, 9.3, 14.25, 6.45, 11.15, 14.95)
const.mat <- matrix(c(rep(1,5),rep(0,10),
                      rep(0,5),rep(1,5),rep(0,5),
                      rep(0,10),rep(1,5),
                      rep(0,0),1,rep(0,4),1,rep(0,4),1,rep(0,4),
                      rep(0,1),1,rep(0,4),1,rep(0,4),1,rep(0,3),
                      rep(0,2),1,rep(0,4),1,rep(0,4),1,rep(0,2),
                      rep(0,3),1,rep(0,4),1,rep(0,4),1,rep(0,1),
                      rep(0,4),1,rep(0,4),1,rep(0,4),1,rep(0,0),
                      rep(0,0),1,rep(0,14),
                      rep(0,1),1,rep(0,13),
                      rep(0,2),1,rep(0,12),
                      rep(0,3),1,rep(0,11),
                      rep(0,4),1,rep(0,10),
                      rep(0,5),1,rep(0,9),
                      rep(0,6),1,rep(0,8),
                      rep(0,7),1,rep(0,7),
                      rep(0,8),1,rep(0,6),
                      rep(0,9),1,rep(0,5),
                      rep(0,10),1,rep(0,4),
                      rep(0,11),1,rep(0,3),
                      rep(0,12),1,rep(0,2),
                      rep(0,13),1,rep(0,1),
                      rep(0,14),1,rep(0,0)),
                    ncol = 15,byrow = T)
const.dir <- c(rep('<=',3),rep('=',5),rep('>=',15))
const.rhs <- c(1300, 900, 400, 160, 330, 600, 590, 880, rep(0,15))
lp.solution <- lp('min',objective.fn,const.mat,const.dir,const.rhs, all.int = T)
lp.solution$solution
lp.solution
```

The optimal solution would be to send 330,50 and 880 tins of milk powder from factory A to centers B, D and E respectively, send 160, 200 and 540 tins of milk powder from factory B to centers A, C and D respectively and send 400 tins of milk powder from factory C to center C. This would yield the lowest transportation costs of \$32312, given the capacity constraints of the factories.

b\. Develop an optimization model to minimize the transportation cost without exceeding production capacity, and still meet demand from distribution centers, if only one new factory is to be built. (7 mark)

To do this, need to make two models, one for factory D and one for factory E

| Minimize costs using decision variables $X_{11}$, $X_{12}$, $X_{13}$, $X_{14}$, $X_{15}$, $X_{21}$, $X_{22}$, $X_{23}$, $X_{24}$, $X_{25}$, $X_{31}$, $X_{32}$, $X_{33}$, $X_{34}$, $X_{35}$, $X_{41}$, $X_{42}$, $X_{43}$, $X_{44}$, $X_{45}$ | Costs= 12.40$X_{11}$ + 13.75$X_{12}$ + 12.30$X_{13}$ + 12.15$X_{14}$ + 18.35$X_{15}$ + 8.5$X_{21}$ + 18.55$X_{22}$ + 8.80$X_{23}$ + 9.85$X_{24}$ + 16.45$X_{25}$ + 9.3$X_{31}$ + 14.25$X_{32}$ + 6.45$X_{33}$ + 11.15$X_{34}$ + 14.95$X_{35}$ + 11.40$X_{41}$ + 10.60$X_{42}$ + 9.75$X_{43}$ + 13.55$X_{44}$ + 11.95$X_{45}$ |
|------------------------------------|------------------------------------|
| Subject to                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                              |
| Maximum for factory A                                                                                                                                                                                                                          | $X_{11}$ + $X_{12}$ + $X_{13}$ + $X_{14}$ + $X_{15}$ $\leq$ 1300                                                                                                                                                                                                                                                             |
| Maximum for factory B                                                                                                                                                                                                                          | $X_{21}$ + $X_{22}$ + $X_{23}$ + $X_{24}$ + $X_{25}$ $\leq$ 900                                                                                                                                                                                                                                                              |
| Maximum for factory C                                                                                                                                                                                                                          | $X_{31}$ + $X_{32}$ + $X_{33}$ + $X_{34}$ + $X_{35}$ $\leq$ 400                                                                                                                                                                                                                                                              |
| Maximum for factory D                                                                                                                                                                                                                          | $X_{41}$ + $X_{42}$ + $X_{43}$ + $X_{44}$ + $X_{45}$ $\leq$ 1200                                                                                                                                                                                                                                                             |
| Center A                                                                                                                                                                                                                                       | $X_{11}$ + $X_{21}$ + $X_{31}$ + $X_{41}$ = 176                                                                                                                                                                                                                                                                              |
| Center B                                                                                                                                                                                                                                       | $X_{12}$ + $X_{22}$ + $X_{32}$ + $X_{42}$= 363                                                                                                                                                                                                                                                                               |
| Center C                                                                                                                                                                                                                                       | $X_{13}$ + $X_{23}$ + $X_{33}$ + $X_{43}$= 660                                                                                                                                                                                                                                                                               |
| Center D                                                                                                                                                                                                                                       | $X_{14}$ + $X_{24}$ + $X_{34}$ + $X_{44}$= 649                                                                                                                                                                                                                                                                               |
| Center E                                                                                                                                                                                                                                       | $X_{15}$ + $X_{25}$ + $X_{35}$ + $X_{45}$= 968                                                                                                                                                                                                                                                                               |
| Integer, Non-Negativity Constraints                                                                                                                                                                                                            | $X_{11}$ to $X_{45}$ all integers and $\geq$ 0                                                                                                                                                                                                                                                                               |

```{r q5a D,echo=T}
objective.fn <- c(12.4, 13.75, 12.3, 12.15, 18.35, 8.5, 18.55, 8.80, 9.85, 16.45, 9.3, 14.25, 6.45, 11.15, 14.95, 11.4, 10.6, 9.75, 13.55, 11.95)
const.mat <- matrix(c(rep(1,5),rep(0,15),
                      rep(0,5),rep(1,5),rep(0,10),
                      rep(0,10),rep(1,5),rep(0,5),
                      rep(0,15),rep(1,5),
                      rep(0,0),1,rep(c(0,0,0,0,1),3),rep(0,4),
                      rep(0,1),1,rep(c(0,0,0,0,1),3),rep(0,3),
                      rep(0,2),1,rep(c(0,0,0,0,1),3),rep(0,2),
                      rep(0,3),1,rep(c(0,0,0,0,1),3),rep(0,1),
                      rep(0,4),1,rep(c(0,0,0,0,1),3),rep(0,0),
                      rep(0,0),1,rep(0,19),
                      rep(0,1),1,rep(0,18),
                      rep(0,2),1,rep(0,17),
                      rep(0,3),1,rep(0,16),
                      rep(0,4),1,rep(0,15),
                      rep(0,5),1,rep(0,14),
                      rep(0,6),1,rep(0,13),
                      rep(0,7),1,rep(0,12),
                      rep(0,8),1,rep(0,11),
                      rep(0,9),1,rep(0,10),
                      rep(0,10),1,rep(0,9),
                      rep(0,11),1,rep(0,8),
                      rep(0,12),1,rep(0,7),
                      rep(0,13),1,rep(0,6),
                      rep(0,14),1,rep(0,5),
                      rep(0,15),1,rep(0,4),
                      rep(0,16),1,rep(0,3),
                      rep(0,17),1,rep(0,2),
                      rep(0,18),1,rep(0,1),
                      rep(0,19),1,rep(0,0)),
                    ncol = 20,byrow = T)
const.dir <- c(rep('<=',4),rep('=',5),rep('>=',20))
const.rhs <- c(1300, 900, 400, 1200, 176, 363, 660, 649, 968, rep(0,20))
lp.solution <- lp('min',objective.fn,const.mat,const.dir,const.rhs, all.int = T)
lp.solution$solution
lp.solution

```

| Minimize costs using decision variables $X_{11}$, $X_{12}$, $X_{13}$, $X_{14}$, $X_{15}$, $X_{21}$, $X_{22}$, $X_{23}$, $X_{24}$, $X_{25}$, $X_{31}$, $X_{32}$, $X_{33}$, $X_{34}$, $X_{35}$, $X_{41}$, $X_{42}$, $X_{43}$, $X_{44}$, $X_{45}$ | Costs= 12.40$X_{11}$ + 13.75$X_{12}$ + 12.30$X_{13}$ + 12.15$X_{14}$ + 18.35$X_{15}$ + 8.5$X_{21}$ + 18.55$X_{22}$ + 8.80$X_{23}$ + 9.85$X_{24}$ + 16.45$X_{25}$ + 9.3$X_{31}$ + 14.25$X_{32}$ + 6.45$X_{33}$ + 11.15$X_{34}$ + 14.95$X_{35}$ + 14.10$X_{41}$ + 15.50$X_{42}$ + 13.85$X_{43}$ + 9.45$X_{44}$ + 12.25$X_{45}$ |
|------------------------------------|------------------------------------|
| Subject to                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                              |
| Maximum for factory A                                                                                                                                                                                                                          | $X_{11}$ + $X_{12}$ + $X_{13}$ + $X_{14}$ + $X_{15}$ $\leq$ 1300                                                                                                                                                                                                                                                             |
| Maximum for factory B                                                                                                                                                                                                                          | $X_{21}$ + $X_{22}$ + $X_{23}$ + $X_{24}$ + $X_{25}$ $\leq$ 900                                                                                                                                                                                                                                                              |
| Maximum for factory C                                                                                                                                                                                                                          | $X_{31}$ + $X_{32}$ + $X_{33}$ + $X_{34}$ + $X_{35}$ $\leq$ 400                                                                                                                                                                                                                                                              |
| Maximum for factory E                                                                                                                                                                                                                          | $X_{41}$ + $X_{42}$ + $X_{43}$ + $X_{44}$ + $X_{45}$ $\leq$ 1200                                                                                                                                                                                                                                                             |
| Center A                                                                                                                                                                                                                                       | $X_{11}$ + $X_{21}$ + $X_{31}$ + $X_{41}$ = 176                                                                                                                                                                                                                                                                              |
| Center B                                                                                                                                                                                                                                       | $X_{12}$ + $X_{22}$ + $X_{32}$ + $X_{42}$= 363                                                                                                                                                                                                                                                                               |
| Center C                                                                                                                                                                                                                                       | $X_{13}$ + $X_{23}$ + $X_{33}$ + $X_{43}$= 660                                                                                                                                                                                                                                                                               |
| Center D                                                                                                                                                                                                                                       | $X_{14}$ + $X_{24}$ + $X_{34}$ + $X_{44}$= 649                                                                                                                                                                                                                                                                               |
| Center E                                                                                                                                                                                                                                       | $X_{15}$ + $X_{25}$ + $X_{35}$ + $X_{45}$= 968                                                                                                                                                                                                                                                                               |
| Integer, Non-Negativity Constraints                                                                                                                                                                                                            | $X_{11}$ to $X_{45}$ all integers and $\geq$ 0                                                                                                                                                                                                                                                                               |

```{r q5a E,echo=T}
objective.fn <- c(12.4, 13.75, 12.3, 12.15, 18.35, 8.5, 18.55, 8.80, 9.85, 16.45, 9.3, 14.25, 6.45, 11.15, 14.95, 14.1, 15.5, 13.85, 9.45, 12.25)
const.mat <- matrix(c(rep(1,5),rep(0,15),
                      rep(0,5),rep(1,5),rep(0,10),
                      rep(0,10),rep(1,5),rep(0,5),
                      rep(0,15),rep(1,5),
                      rep(0,0),1,rep(c(0,0,0,0,1),3),rep(0,4),
                      rep(0,1),1,rep(c(0,0,0,0,1),3),rep(0,3),
                      rep(0,2),1,rep(c(0,0,0,0,1),3),rep(0,2),
                      rep(0,3),1,rep(c(0,0,0,0,1),3),rep(0,1),
                      rep(0,4),1,rep(c(0,0,0,0,1),3),rep(0,0),
                      rep(0,0),1,rep(0,19),
                      rep(0,1),1,rep(0,18),
                      rep(0,2),1,rep(0,17),
                      rep(0,3),1,rep(0,16),
                      rep(0,4),1,rep(0,15),
                      rep(0,5),1,rep(0,14),
                      rep(0,6),1,rep(0,13),
                      rep(0,7),1,rep(0,12),
                      rep(0,8),1,rep(0,11),
                      rep(0,9),1,rep(0,10),
                      rep(0,10),1,rep(0,9),
                      rep(0,11),1,rep(0,8),
                      rep(0,12),1,rep(0,7),
                      rep(0,13),1,rep(0,6),
                      rep(0,14),1,rep(0,5),
                      rep(0,15),1,rep(0,4),
                      rep(0,16),1,rep(0,3),
                      rep(0,17),1,rep(0,2),
                      rep(0,18),1,rep(0,1),
                      rep(0,19),1,rep(0,0)),
                    ncol = 20,byrow = T)
const.dir <- c(rep('<=',4),rep('=',5),rep('>=',20))
const.rhs <- c(1300, 900, 400, 1200, 176, 363, 660, 649, 968, rep(0,20))
lp.solution <- lp('min',objective.fn,const.mat,const.dir,const.rhs, all.int = T)
lp.solution$solution
lp.solution

```

From the two linear models, we can see that the minimum transport costs to fulfill the increased demands should Factory D be opened would be \$29010.20, while the minimum transport costs to fulfill the increased demands should factory E be opened would be \$29513.10. Hence, factory D should be opened instead of factory E if we want to minimize transportation costs.

# Question 6 (16m)

(a) Develop a simple moving average table, determine the value of k observations by using Mean Square Error (MSE), and forecast the sale for Week 11. (8 mark)

(b) Develop an exponential smoothing table, determine the value of the smoothing constant (0.1, 0.3, 0.5, 0.7, 0.9) by using Root Mean Square Error (RMSE), and forecast the sale for Week 11. (8 mark)

```{r q6, echo = TRUE}
week <- c(1,2,3,4,5,6,7,8,9,10)
tins_sold <- c(15,18,37,40,39,38,35,41,55,30)
milk_df <- data.frame(week,tins_sold)
colnames(milk_df) <- c('Week','Tins Sold')
milk_df

#find best value for k to give smallest root mean squared error
for(k in 1:8) {
  milk_df$tins_soldSMA<- dplyr::lag(SMA(milk_df$`Tins Sold`, n=k),1)
  print(k)
  print(mean((milk_df$tins_soldSMA - milk_df$`Tins Sold`)^2,na.rm=T))
}

# since k = 5 gives the smallest RMSE
milk_df$soldSMA <- dplyr::lag(SMA(milk_df$`Tins Sold`, n=5),1)
milk_df$soldSMA

# part b
milk_dfmain <- milk_df[1:7,]
milk_dfHeldout <- milk_df[8:10,]
milk_dfHeldout

hwcorrect <- HoltWinters(milk_df$`Tins Sold`,gamma=F)
hwcorrect_pred <- predict(hwcorrect,n.ahead = 1 )
plot(hwcorrect)

for(k in c(0.1,0.3,0.5,0.7,0.9)) {
  hw1 <- HoltWinters(milk_dfmain$`Tins Sold`,alpha=k,gamma=F)
  hw1_pred <- predict(hw1,n.ahead = 3)
  print(k)
  print(sqrt(mean((hw1_pred-milk_dfHeldout$`Tins Sold`)^2,na.rm = T)))
}
```

Using the SMA model, we lag the data by 1 so that we can use data from the past k weeks to predict the data for the k+1th week. From there, we find out that from values of [1:8], k=5 gives the smallest mean squared error. This means that we use data from the past 5 weeks to predict the number of milk tins sold for the next week. The forecast for week 11 would thus be the sum of sales from weeks 6-10 divided by 5=40.

We first create two data sets, one for weeks 1-7, and another for weeks 8,9,10 to be used as our test case. Using the data from weeks 1-7, we apply a Holt Winters model with different smoothing constants. We then use this model to predict the sales volume for weeks 8-10. Using this prediction and the actual data from weeks 8-10, we calculate the RMSE and find the smoothing constant which gives the smallest RMSE. We then use this smoothing constant to predict the sales volume for week 11, which would be 49.
